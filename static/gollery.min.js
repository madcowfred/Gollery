window.Modernizr=function(e,t,i){function n(e){$.cssText=e}function r(e,t){return typeof e===t}function a(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var n in e){var r=e[n];if(!a(r,"-")&&$[r]!==i)return"pfx"==t?r:!0}return!1}function s(e,t,n){for(var a in e){var o=t[e[a]];if(o!==i)return n===!1?e[a]:r(o,"function")?o.bind(n||t):o}return!1}function c(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+w.join(n+" ")+n).split(" ");return r(t,"string")||r(t,"undefined")?o(a,t):(a=(e+" "+b.join(n+" ")+n).split(" "),s(a,t,i))}var l,d,h,u="2.6.2",f={},p=!0,m=t.documentElement,g="modernizr",v=t.createElement(g),$=v.style,y=({}.toString,"Webkit Moz O ms"),w=y.split(" "),b=y.toLowerCase().split(" "),E={},x=[],T=x.slice,A={}.hasOwnProperty;h=r(A,"undefined")||r(A.call,"undefined")?function(e,t){return t in e&&r(e.constructor.prototype[t],"undefined")}:function(e,t){return A.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=T.call(arguments,1),n=function(){if(this instanceof n){var r=function(){};r.prototype=t.prototype;var a=new r,o=t.apply(a,i.concat(T.call(arguments)));return Object(o)===o?o:a}return t.apply(e,i.concat(T.call(arguments)))};return n}),E.csstransitions=function(){return c("transition")};for(var C in E)h(E,C)&&(d=C.toLowerCase(),f[d]=E[C](),x.push((f[d]?"":"no-")+d));return f.addTest=function(e,t){if("object"==typeof e)for(var n in e)h(e,n)&&f.addTest(n,e[n]);else{if(e=e.toLowerCase(),f[e]!==i)return f;t="function"==typeof t?t():t,"undefined"!=typeof p&&p&&(m.className+=" "+(t?"":"no-")+e),f[e]=t}return f},n(""),v=l=null,function(e,t){function i(e,t){var i=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return i.innerHTML="x<style>"+t+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function r(e){var t=g[e[p]];return t||(t={},m++,e[p]=m,g[m]=t),t}function a(e,i,n){if(i||(i=t),d)return i.createElement(e);n||(n=r(i));var a;return a=n.cache[e]?n.cache[e].cloneNode():f.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),a.canHaveChildren&&!u.test(e)?n.frag.appendChild(a):a}function o(e,i){if(e||(e=t),d)return e.createDocumentFragment();i=i||r(e);for(var a=i.frag.cloneNode(),o=0,s=n(),c=s.length;c>o;o++)a.createElement(s[o]);return a}function s(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(i){return v.shivMethods?a(i,e,t):t.createElem(i)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function c(e){e||(e=t);var n=r(e);return v.shivCSS&&!l&&!n.hasCSS&&(n.hasCSS=!!i(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),d||s(e,n),e}var l,d,h=e.html5||{},u=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,p="_html5shiv",m=0,g={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",l="hidden"in e,d=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(i){l=!0,d=!0}}();var v={elements:h.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:h.shivCSS!==!1,supportsUnknownElements:d,shivMethods:h.shivMethods!==!1,type:"default",shivDocument:c,createElement:a,createDocumentFragment:o};e.html5=v,c(t)}(this,t),f._version=u,f._domPrefixes=b,f._cssomPrefixes=w,f.testProp=function(e){return o([e])},f.testAllProps=c,f.prefixed=function(e,t,i){return t?c(e,t,i):c(e,"pfx")},m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(p?" js "+x.join(" "):""),f}(this,this.document),function(e,t,i){function n(e){return"[object Function]"==g.call(e)}function r(e){return"string"==typeof e}function a(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function s(){var e=v.shift();$=1,e?e.t?p(function(){("c"==e.t?u.injectCss:u.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),s()):$=0}function c(e,i,n,r,a,c,l){function d(t){if(!f&&o(h.readyState)&&(y.r=f=1,!$&&s(),h.onload=h.onreadystatechange=null,t)){"img"!=e&&p(function(){b.removeChild(h)},50);for(var n in C[i])C[i].hasOwnProperty(n)&&C[i][n].onload()}}var l=l||u.errorTimeout,h=t.createElement(e),f=0,g=0,y={t:n,s:i,e:a,a:c,x:l};1===C[i]&&(g=1,C[i]=[]),"object"==e?h.data=i:(h.src=i,h.type=e),h.width=h.height="0",h.onerror=h.onload=h.onreadystatechange=function(){d.call(this,g)},v.splice(r,0,y),"img"!=e&&(g||2===C[i]?(b.insertBefore(h,w?null:m),p(d,l)):C[i].push(h))}function l(e,t,i,n,a){return $=0,t=t||"j",r(e)?c("c"==t?x:E,e,t,this.i++,i,n,a):(v.splice(this.i++,0,e),1==v.length&&s()),this}function d(){var e=u;return e.loader={load:l,i:0},e}var h,u,f=t.documentElement,p=e.setTimeout,m=t.getElementsByTagName("script")[0],g={}.toString,v=[],$=0,y="MozAppearance"in f.style,w=y&&!!t.createRange().compareNode,b=w?f:m.parentNode,f=e.opera&&"[object Opera]"==g.call(e.opera),f=!!t.attachEvent&&!f,E=y?"object":f?"script":"img",x=f?"script":E,T=Array.isArray||function(e){return"[object Array]"==g.call(e)},A=[],C={},j={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};u=function(e){function t(e){var t,i,n,e=e.split("!"),r=A.length,a=e.pop(),o=e.length,a={url:a,origUrl:a,prefixes:e};for(i=0;o>i;i++)n=e[i].split("="),(t=j[n.shift()])&&(a=t(a,n));for(i=0;r>i;i++)a=A[i](a);return a}function o(e,r,a,o,s){var c=t(e),l=c.autoCallback;c.url.split(".").pop().split("?").shift(),c.bypass||(r&&(r=n(r)?r:r[e]||r[o]||r[e.split("/").pop().split("?")[0]]),c.instead?c.instead(e,r,a,o,s):(C[c.url]?c.noexec=!0:C[c.url]=1,a.load(c.url,c.forceCSS||!c.forceJS&&"css"==c.url.split(".").pop().split("?").shift()?"c":i,c.noexec,c.attrs,c.timeout),(n(r)||n(l))&&a.load(function(){d(),r&&r(c.origUrl,s,o),l&&l(c.origUrl,s,o),C[c.url]=2})))}function s(e,t){function i(e,i){if(e){if(r(e))i||(h=function(){var e=[].slice.call(arguments);u.apply(this,e),f()}),o(e,h,t,0,l);else if(Object(e)===e)for(c in s=function(){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i}(),e)e.hasOwnProperty(c)&&(!i&&!--s&&(n(h)?h=function(){var e=[].slice.call(arguments);u.apply(this,e),f()}:h[c]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),f()}}(u[c])),o(e[c],h,t,c,l))}else!i&&f()}var s,c,l=!!e.test,d=e.load||e.both,h=e.callback||a,u=h,f=e.complete||a;i(l?e.yep:e.nope,!!d),d&&i(d)}var c,l,h=this.yepnope.loader;if(r(e))o(e,0,h,0);else if(T(e))for(c=0;c<e.length;c++)l=e[c],r(l)?o(l,0,h,0):T(l)?u(l):Object(l)===l&&s(l,h);else Object(e)===e&&s(e,h)},u.addPrefix=function(e,t){j[e]=t},u.addFilter=function(e){A.push(e)},u.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",h=function(){t.removeEventListener("DOMContentLoaded",h,0),t.readyState="complete"},0)),e.yepnope=d(),e.yepnope.executeStack=s,e.yepnope.injectJs=function(e,i,n,r,c,l){var d,h,f=t.createElement("script"),r=r||u.errorTimeout;f.src=e;for(h in n)f.setAttribute(h,n[h]);i=l?s:i||a,f.onreadystatechange=f.onload=function(){!d&&o(f.readyState)&&(d=1,i(),f.onload=f.onreadystatechange=null)},p(function(){d||(d=1,i(1))},r),c?f.onload():m.parentNode.insertBefore(f,m)},e.yepnope.injectCss=function(e,i,n,r,o,c){var l,r=t.createElement("link"),i=c?s:i||a;r.href=e,r.rel="stylesheet",r.type="text/css";for(l in n)r.setAttribute(l,n[l]);o||(m.parentNode.insertBefore(r,m),p(i,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};var $event=$.event,$special,resizeTimeout;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(e,t){var i=this,n=arguments,r=function(){e.type="debouncedresize",$event.dispatch.apply(i,n)};resizeTimeout&&clearTimeout(resizeTimeout),t?r():resizeTimeout=setTimeout(r,$special.threshold)},threshold:250};var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(e){function t(){var t=$(c),i=$(l);r&&(l.length?r.reject(o,t,i):r.resolve(o)),$.isFunction(e)&&e.call(n,o,t,i)}function i(e,i){e.src!==BLANK&&-1===$.inArray(e,s)&&(s.push(e),i?l.push(e):c.push(e),$.data(e,"imagesLoaded",{isBroken:i,src:e.src}),a&&r.notifyWith($(e),[i,o,$(c),$(l)]),o.length===s.length&&(setTimeout(t),o.unbind(".imagesLoaded")))}var n=this,r=$.isFunction($.Deferred)?$.Deferred():0,a=$.isFunction(r.notify),o=n.find("img").add(n.filter("img")),s=[],c=[],l=[];return $.isPlainObject(e)&&$.each(e,function(t,i){"callback"===t?e=i:r&&r[t](i)}),o.length?o.bind("load.imagesLoaded error.imagesLoaded",function(e){i(e.target,"error"===e.type)}).each(function(e,t){var n=t.src,r=$.data(t,"imagesLoaded");return r&&r.src===n?(i(t,r.isBroken),void 0):t.complete&&void 0!==t.naturalWidth?(i(t,0===t.naturalWidth||0===t.naturalHeight),void 0):((t.readyState||t.complete)&&(t.src=BLANK,t.src=n),void 0)}):t(),r?r.promise(n):n};var Grid=function(){function e(e){b=$.extend(!0,{},b,e),l.imagesLoaded(function(){t(!0),r(),i();var e=document.location.hash.substring(1);e&&$('a[data-title="'+e+'"]').click()})}function t(e){d.each(function(){var t=$(this);t.data("offsetTop",t.offset().top),e&&t.data("height",t.height())})}function i(){n(d),m.on("debouncedresize",function(){f=0,u=-1,t(),r();var e=$.data(this,"preview");"undefined"!=typeof e&&o()})}function n(e){e.on("click","span.og-close",function(){return o(),!1}).children("a").on("click",function(){var e=$(this).parent();return h===e.index()?o():a(e),!1})}function r(){c={width:m.width(),height:m.height()}}function a(e){var t=$.data(this,"preview"),i=e.data("offsetTop");if(f=0,"undefined"!=typeof t){if(u===i)return t.update(e),!1;i>u&&(f=t.height),o()}window.location.replace(window.location.href.split("#")[0]+"#"+e.children("a").data("title")),u=i,t=$.data(this,"preview",new s(e)),t.open()}function o(){var e=m.scrollTop();h=-1;var t=$.data(this,"preview");t.close(),$.removeData(this,"preview"),window.location.replace(window.location.href.split("#")[0]+"#"),m.scrollTop(e)}function s(e){this.$item=e,this.expandedIdx=this.$item.index(),this.create(),this.update()}var c,l=$("#og-grid"),d=l.children("li"),h=-1,u=-1,f=-10,p=10,m=$(window),g=$("html, body"),v={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},y=v[Modernizr.prefixed("transition")],w=Modernizr.csstransitions,b={minHeight:500,speed:100,easing:"ease"};return s.prototype={create:function(){this.$title=$("<h3></h3>"),this.$description=$('<div class="og-desc"></div>'),this.$href=$('<a href="#" target="_blank">Original image</a>'),this.$details=$('<div class="og-details"></div>').append(this.$title,this.$description,this.$href),this.$loading=$('<div class="og-loading"></div>'),this.$fullimage=$('<div class="og-fullimg"></div>').append(this.$loading),this.$closePreview=$('<span class="og-close"></span>'),this.$previewInner=$('<div class="og-expander-inner"></div>').append(this.$closePreview,this.$fullimage,this.$details),this.$previewEl=$('<div class="og-expander"></div>').append(this.$previewInner),this.$item.append(this.getEl()),w&&this.setTransition()},update:function(e){if(e&&(this.$item=e),-1!==h){var t=d.eq(h);t.removeClass("og-expanded"),this.$item.addClass("og-expanded"),this.positionPreview()}h=this.$item.index();var i=this.$item.children("a"),n={href:i.attr("href"),largesrc:i.data("largesrc"),title:i.data("title"),dimensions:i.data("dimensions"),size:i.data("size"),modified:i.data("modified")};this.$title.html(n.title),this.$href.attr("href",n.href);var r="<p>Dimensions</p><p>"+n.dimensions+"</p>";r+="<p>File size</p><p>"+n.size+"</p>",r+="<p>Modified</p><p>"+n.modified+"</p>",this.$description.html(r);var a=this;"undefined"!=typeof a.$largeImg&&a.$largeImg.remove(),a.$fullimage.is(":visible")&&(this.$loading.show(),$("<img/>").load(function(){var e=$(this);e.attr("src")===a.$item.children("a").data("largesrc")&&(a.$loading.hide(),a.$fullimage.find("img").remove(),a.$largeImg=e.fadeIn(350),a.$fullimage.append(a.$largeImg))}).attr("src",n.largesrc))},open:function(){setTimeout($.proxy(function(){this.setHeights(),this.positionPreview()},this),25)},close:function(){var e=this,t=function(){w&&$(this).off(y),e.$item.removeClass("og-expanded"),e.$previewEl.remove()};return setTimeout($.proxy(function(){"undefined"!=typeof this.$largeImg&&this.$largeImg.fadeOut("fast"),this.$previewEl.css("height",0);var e=d.eq(this.expandedIdx);e.css("height",e.data("height")).on(y,t),w||t.call()},this),25),!1},calcHeight:function(){var e=c.height-this.$item.data("height")-p,t=c.height;e<b.minHeight&&(e=b.minHeight,t=b.minHeight+this.$item.data("height")+p),this.height=e,this.itemHeight=t},setHeights:function(){var e=this,t=function(){w&&e.$item.off(y),e.$item.addClass("og-expanded")};this.calcHeight(),this.$previewEl.css("height",this.height),this.$item.css("height",this.itemHeight).on(y,t),w||t.call()},positionPreview:function(){var e=this.$item.data("offsetTop"),t=this.$previewEl.offset().top-f,i=this.height+this.$item.data("height")+p<=c.height?e:this.height<c.height?t-(c.height-this.height):t;i-=6,g.animate({scrollTop:i},b.speed)},setTransition:function(){this.$previewEl.css("transition","height "+b.speed+"ms "+b.easing),this.$item.css("transition","height "+b.speed+"ms "+b.easing)},getEl:function(){return this.$previewEl}},{init:e}}();$(document).ready(function(){Grid.init()});