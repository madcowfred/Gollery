window.Modernizr=function(e,t,i){function n(e){$.cssText=e}function a(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var n in e){var a=e[n];if(!r(a,"-")&&$[a]!==i)return"pfx"==t?a:!0}return!1}function s(e,t,n){for(var r in e){var o=t[e[r]];if(o!==i)return n===!1?e[r]:a(o,"function")?o.bind(n||t):o}return!1}function c(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+w.join(n+" ")+n).split(" ");return a(t,"string")||a(t,"undefined")?o(r,t):(r=(e+" "+b.join(n+" ")+n).split(" "),s(r,t,i))}var d,l,h,u="2.8.2",f={},p=!0,m=t.documentElement,g="modernizr",v=t.createElement(g),$=v.style,y=({}.toString,"Webkit Moz O ms"),w=y.split(" "),b=y.toLowerCase().split(" "),E={},T=[],x=T.slice,A={}.hasOwnProperty;h=a(A,"undefined")||a(A.call,"undefined")?function(e,t){return t in e&&a(e.constructor.prototype[t],"undefined")}:function(e,t){return A.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=x.call(arguments,1),n=function(){if(this instanceof n){var a=function(){};a.prototype=t.prototype;var r=new a,o=t.apply(r,i.concat(x.call(arguments)));return Object(o)===o?o:r}return t.apply(e,i.concat(x.call(arguments)))};return n}),E.csstransitions=function(){return c("transition")},E.video=function(){var e=t.createElement("video"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),i.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),i.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(n){}return i};for(var z in E)h(E,z)&&(l=z.toLowerCase(),f[l]=E[z](),T.push((f[l]?"":"no-")+l));return f.addTest=function(e,t){if("object"==typeof e)for(var n in e)h(e,n)&&f.addTest(n,e[n]);else{if(e=e.toLowerCase(),f[e]!==i)return f;t="function"==typeof t?t():t,"undefined"!=typeof p&&p&&(m.className+=" "+(t?"":"no-")+e),f[e]=t}return f},n(""),v=d=null,function(e,t){function i(e,t){var i=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return i.innerHTML="x<style>"+t+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var e=$.elements;return"string"==typeof e?e.split(" "):e}function a(e){var t=v[e[m]];return t||(t={},g++,e[m]=g,v[g]=t),t}function r(e,i,n){if(i||(i=t),l)return i.createElement(e);n||(n=a(i));var r;return r=n.cache[e]?n.cache[e].cloneNode():p.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),!r.canHaveChildren||f.test(e)||r.tagUrn?r:n.frag.appendChild(r)}function o(e,i){if(e||(e=t),l)return e.createDocumentFragment();i=i||a(e);for(var r=i.frag.cloneNode(),o=0,s=n(),c=s.length;c>o;o++)r.createElement(s[o]);return r}function s(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(i){return $.shivMethods?r(i,e,t):t.createElem(i)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")($,t.frag)}function c(e){e||(e=t);var n=a(e);return $.shivCSS&&!d&&!n.hasCSS&&(n.hasCSS=!!i(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),l||s(e,n),e}var d,l,h="3.7.0",u=e.html5||{},f=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",g=0,v={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",d="hidden"in e,l=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(i){d=!0,l=!0}}();var $={elements:u.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:h,shivCSS:u.shivCSS!==!1,supportsUnknownElements:l,shivMethods:u.shivMethods!==!1,type:"default",shivDocument:c,createElement:r,createDocumentFragment:o};e.html5=$,c(t)}(this,t),f._version=u,f._domPrefixes=b,f._cssomPrefixes=w,f.testProp=function(e){return o([e])},f.testAllProps=c,f.prefixed=function(e,t,i){return t?c(e,t,i):c(e,"pfx")},m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(p?" js "+T.join(" "):""),f}(this,this.document);var $event=$.event,$special,resizeTimeout;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(e,t){var i=this,n=arguments,a=function(){e.type="debouncedresize",$event.dispatch.apply(i,n)};resizeTimeout&&clearTimeout(resizeTimeout),t?a():resizeTimeout=setTimeout(a,$special.threshold)},threshold:250};var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(e){function t(){var t=$(c),i=$(d);a&&(d.length?a.reject(o,t,i):a.resolve(o)),$.isFunction(e)&&e.call(n,o,t,i)}function i(e,i){e.src!==BLANK&&-1===$.inArray(e,s)&&(s.push(e),i?d.push(e):c.push(e),$.data(e,"imagesLoaded",{isBroken:i,src:e.src}),r&&a.notifyWith($(e),[i,o,$(c),$(d)]),o.length===s.length&&(setTimeout(t),o.unbind(".imagesLoaded")))}var n=this,a=$.isFunction($.Deferred)?$.Deferred():0,r=$.isFunction(a.notify),o=n.find("img").add(n.filter("img")),s=[],c=[],d=[];return $.isPlainObject(e)&&$.each(e,function(t,i){"callback"===t?e=i:a&&a[t](i)}),o.length?o.bind("load.imagesLoaded error.imagesLoaded",function(e){i(e.target,"error"===e.type)}).each(function(e,t){var n=t.src,a=$.data(t,"imagesLoaded");return a&&a.src===n?(i(t,a.isBroken),void 0):t.complete&&void 0!==t.naturalWidth?(i(t,0===t.naturalWidth||0===t.naturalHeight),void 0):((t.readyState||t.complete)&&(t.src=BLANK,t.src=n),void 0)}):t(),a?a.promise(n):n};var Grid=function(){function e(e){b=$.extend(!0,{},b,e),d.imagesLoaded(function(){t(!0),a(),i();var e=document.location.hash.substring(1);e&&$('a[data-title="'+e+'"]').click()})}function t(e){l.each(function(){var t=$(this);t.data("offsetTop",t.offset().top),e&&t.data("height",t.height())})}function i(){n(l),m.on("debouncedresize",function(){f=0,u=-1,t(),a();var e=$.data(this,"preview");"undefined"!=typeof e&&o()})}function n(e){e.on("click","span.og-close",function(){return o(),!1}).children("a").on("click",function(){var e=$(this).parent();return h===e.index()?o():r(e),!1})}function a(){c={width:m.width(),height:m.height()}}function r(e){var t=$.data(this,"preview"),i=e.data("offsetTop");if(f=0,window.location.replace(window.location.href.split("#")[0]+"#"+e.children("a").data("title")),"undefined"!=typeof t){if(u===i)return t.update(e),!1;i>u&&(f=t.height),o(!0)}u=i,t=$.data(this,"preview",new s(e)),t.open()}function o(e){var t=m.scrollTop();h=-1;var i=$.data(this,"preview");i.close(),$.removeData(this,"preview"),e!==!0&&window.location.replace(window.location.href.split("#")[0]+"#"),m.scrollTop(t)}function s(e){this.$item=e,this.expandedIdx=this.$item.index(),this.create(),this.update()}var c,d=$("#og-grid"),l=d.children("li"),h=-1,u=-1,f=-10,p=0,m=$(window),g=$("html, body"),v={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},y=v[Modernizr.prefixed("transition")],w=Modernizr.csstransitions,b={minHeight:500,speed:100,easing:"ease"},E=Modernizr.video.webm;return s.prototype={create:function(){this.$title=$("<h3></h3>"),this.$description=$('<div class="og-desc"></div>'),this.$href=$('<div class="og-links"></div>'),this.$prevnext=$('<div class="og-prevnext"></div>'),this.$details=$('<div class="og-details"></div>').append(this.$title,this.$description,this.$href,this.$prevnext),this.$loading=$('<div class="og-loading"></div>'),this.$fullimage=$('<div class="og-fullimg"></div>').append(this.$loading),this.$closePreview=$('<span class="og-close"></span>'),this.$previewInner=$('<div class="og-expander-inner"></div>').append(this.$closePreview,this.$fullimage,this.$details),this.$previewEl=$('<div class="og-expander"></div>').append(this.$previewInner),this.$item.append(this.getEl()),w&&this.setTransition()},update:function(e){if(e&&(this.$item=e),-1!==h){var t=l.eq(h);t.removeClass("og-expanded"),this.$item.addClass("og-expanded"),this.positionPreview()}h=this.$item.index();var i=this.$item.children("a"),n={href:i.attr("href"),largesrc:i.data("largesrc"),title:i.data("title"),dimensions:i.data("dimensions"),size:i.data("size"),modified:i.data("modified"),video:i.data("video"),videosize:i.data("videosize")};this.$title.html(n.title),this.$href.html('<a href="'+n.href+'" target="_blank">Original image</a>');var a="<p>Dimensions</p><p>"+n.dimensions+"</p>";if(a+=E&&n.video?"<p>File size</p><p>"+n.videosize+" ("+n.size+" orig)</p>":"<p>File size</p><p>"+n.size+"</p>",a+="<p>Modified</p><p>"+n.modified+"</p>",this.$description.html(a),a="",h>0){var r="$('.og-grid li:nth-child("+h+") a').click()";a+='<span class="og-prev" onclick="'+r+'">&#8678;</span>'}if(h<l.length-1){var r="$('.og-grid li:nth-child("+(h+2)+") a').click()";a+='<span class="og-next" onclick="'+r+'">&#8680;</span>'}this.$prevnext.html(a);var o=this;if("undefined"!=typeof o.$largeImg&&o.$largeImg.remove(),o.$fullimage.is(":visible"))if(E&&n.video){this.$loading.hide(),o.$fullimage.find("img, video").remove();var a='<video autoplay loop muted="muted"><source src="'+n.video+'" type="video/webm"></video>';o.$fullimage.append(a),o.$href.append('<a href="'+n.video+'" target="_blank">WebM video</a>')}else this.$loading.show(),$("<img/>").load(function(){var e=$(this);e.attr("src")===o.$item.children("a").data("largesrc")&&(o.$loading.hide(),o.$fullimage.find("img, video").remove(),o.$largeImg=e.fadeIn(350),o.$fullimage.append(o.$largeImg))}).attr("src",n.largesrc)},open:function(){setTimeout($.proxy(function(){this.setHeights(),this.positionPreview()},this),25)},close:function(){var e=this,t=function(){w&&$(this).off(y),e.$item.removeClass("og-expanded"),e.$previewEl.remove()};return setTimeout($.proxy(function(){"undefined"!=typeof this.$largeImg&&this.$largeImg.fadeOut("fast"),this.$previewEl.css("height",0);var e=l.eq(this.expandedIdx);e.css("height",e.data("height")).on(y,t),w||t.call()},this),25),!1},calcHeight:function(){var e=c.height-this.$item.data("height")-p,t=c.height;e<b.minHeight&&(e=b.minHeight,t=b.minHeight+this.$item.data("height")+p),this.height=e,this.itemHeight=t},setHeights:function(){var e=this,t=function(){w&&e.$item.off(y),e.$item.addClass("og-expanded")};this.calcHeight(),this.$previewEl.css("height",this.height),this.$item.css("height",this.itemHeight).on(y,t),w||t.call()},positionPreview:function(){var e=this.$item.data("offsetTop"),t=this.$previewEl.offset().top-f,i=this.height+this.$item.data("height")+p<=c.height?e:this.height<c.height?t-(c.height-this.height):t;i-=6,g.animate({scrollTop:i},b.speed)},setTransition:function(){this.$previewEl.css("transition","height "+b.speed+"ms "+b.easing),this.$item.css("transition","height "+b.speed+"ms "+b.easing)},getEl:function(){return this.$previewEl}},{init:e}}();$(document).ready(function(){Grid.init()});